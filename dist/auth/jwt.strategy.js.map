{"version":3,"sources":["../../src/auth/jwt.strategy.ts"],"sourcesContent":["import { ExtractJwt, Strategy } from 'passport-jwt';\nimport { PassportStrategy } from '@nestjs/passport';\nimport { Injectable, UnauthorizedException } from '@nestjs/common';\nimport { UsersService } from '../users/users.service';\n\n@Injectable()\nexport class JwtStrategy extends PassportStrategy(Strategy) {\n  constructor(private usersService: UsersService) {\n    super({\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n      ignoreExpiration: false,\n      secretOrKey: process.env.JWT_SECRET || 'secretKey',\n    });\n  }\n\n  async validate(payload: any) {\n    const user = await this.usersService.findById(payload.sub);\n    if (!user) {\n      throw new UnauthorizedException();\n    }\n    return user;\n  }\n}\n"],"names":["JwtStrategy","PassportStrategy","Strategy","validate","payload","user","usersService","findById","sub","UnauthorizedException","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","ignoreExpiration","secretOrKey","process","env","JWT_SECRET"],"mappings":";;;;+BAMaA;;;eAAAA;;;6BANwB;0BACJ;wBACiB;8BACrB;;;;;;;;;;AAGtB,IAAA,AAAMA,cAAN,MAAMA,oBAAoBC,IAAAA,0BAAgB,EAACC,qBAAQ;IASxD,MAAMC,SAASC,OAAY,EAAE;QAC3B,MAAMC,OAAO,MAAM,IAAI,CAACC,YAAY,CAACC,QAAQ,CAACH,QAAQI,GAAG;QACzD,IAAI,CAACH,MAAM;YACT,MAAM,IAAII,6BAAqB;QACjC;QACA,OAAOJ;IACT;IAdA,YAAY,AAAQC,YAA0B,CAAE;QAC9C,KAAK,CAAC;YACJI,gBAAgBC,uBAAU,CAACC,2BAA2B;YACtDC,kBAAkB;YAClBC,aAAaC,QAAQC,GAAG,CAACC,UAAU,IAAI;QACzC,SALkBX,eAAAA;IAMpB;AASF"}