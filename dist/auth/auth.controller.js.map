{"version":3,"sources":["../../src/auth/auth.controller.ts"],"sourcesContent":["import { Controller, Post, Body, UnauthorizedException } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse } from '@nestjs/swagger';\nimport { AuthService } from './auth.service';\nimport { LoginDto } from './dto/login.dto';\nimport { RegisterDto } from './dto/register.dto';\nimport { LogoutDto } from './dto/logout.dto';\n\ninterface AuthenticatedUser {\n  id: string;\n  email: string;\n  name: string;\n  role: string;\n}\n\n@ApiTags('Auth')\n@Controller('auth')\nexport class AuthController {\n  constructor(private authService: AuthService) {}\n\n  @Post('login')\n  @ApiOperation({ summary: 'User login' })\n  @ApiResponse({ status: 200, description: 'Login successful' })\n  @ApiResponse({ status: 401, description: 'Invalid credentials' })\n  async login(@Body() loginDto: LoginDto) {\n    if (!loginDto || !loginDto.email || !loginDto.password) {\n      throw new UnauthorizedException('Missing email or password');\n    }\n    const user = (await this.authService.validateUser(\n      loginDto.email,\n      loginDto.password,\n    )) as AuthenticatedUser | null;\n    if (!user) {\n      throw new UnauthorizedException('Invalid credentials');\n    }\n    return this.authService.login(user);\n  }\n\n  @Post('register')\n  @ApiOperation({ summary: 'User registration' })\n  @ApiResponse({ status: 201, description: 'Registration successful' })\n  async register(@Body() registerDto: RegisterDto) {\n    return this.authService.register(registerDto);\n  }\n\n  @Post('logout')\n  @ApiOperation({ summary: 'User logout' })\n  @ApiResponse({ status: 200, description: 'Logged out successfully' })\n  async logout(@Body() body: LogoutDto) {\n    return this.authService.logout(body.userId);\n  }\n}\n"],"names":["AuthController","login","loginDto","email","password","UnauthorizedException","user","authService","validateUser","register","registerDto","logout","body","userId","summary","status","description"],"mappings":";;;;+BAgBaA;;;eAAAA;;;wBAhBiD;yBACX;6BACvB;0BACH;6BACG;2BACF;;;;;;;;;;;;;;;AAWnB,IAAA,AAAMA,iBAAN,MAAMA;IAGX,MAIMC,MAAM,AAAQC,QAAkB,EAAE;QACtC,IAAI,CAACA,YAAY,CAACA,SAASC,KAAK,IAAI,CAACD,SAASE,QAAQ,EAAE;YACtD,MAAM,IAAIC,6BAAqB,CAAC;QAClC;QACA,MAAMC,OAAQ,MAAM,IAAI,CAACC,WAAW,CAACC,YAAY,CAC/CN,SAASC,KAAK,EACdD,SAASE,QAAQ;QAEnB,IAAI,CAACE,MAAM;YACT,MAAM,IAAID,6BAAqB,CAAC;QAClC;QACA,OAAO,IAAI,CAACE,WAAW,CAACN,KAAK,CAACK;IAChC;IAEA,MAGMG,SAAS,AAAQC,WAAwB,EAAE;QAC/C,OAAO,IAAI,CAACH,WAAW,CAACE,QAAQ,CAACC;IACnC;IAEA,MAGMC,OAAO,AAAQC,IAAe,EAAE;QACpC,OAAO,IAAI,CAACL,WAAW,CAACI,MAAM,CAACC,KAAKC,MAAM;IAC5C;IAhCA,YAAY,AAAQN,WAAwB,CAAE;aAA1BA,cAAAA;IAA2B;AAiCjD;;;;QA9BkBO,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;QAgBzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa"}