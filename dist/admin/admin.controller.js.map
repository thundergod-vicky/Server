{"version":3,"sources":["../../src/admin/admin.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Patch,\n  Delete,\n  Body,\n  Param,\n  UseGuards,\n  Request,\n  ForbiddenException,\n} from '@nestjs/common';\nimport { AdminService } from './admin.service';\nimport { JwtAuthGuard } from '../auth/jwt-auth.guard';\n\n@Controller('admin')\n@UseGuards(JwtAuthGuard)\nexport class AdminController {\n  constructor(private readonly adminService: AdminService) {}\n\n  private async checkAdmin(req: any) {\n    if (req.user.role !== 'ADMIN') {\n      throw new ForbiddenException(\n        'Only administrators can access this section',\n      );\n    }\n  }\n\n  @Get('stats')\n  async getStats(@Request() req) {\n    await this.checkAdmin(req);\n    return this.adminService.getGlobalStats();\n  }\n\n  @Get('users')\n  async getUsers(@Request() req) {\n    await this.checkAdmin(req);\n    return this.adminService.getAllUsers();\n  }\n\n  @Patch('users/:id/role')\n  async updateRole(\n    @Param('id') userId: string,\n    @Body() data: { role: string },\n    @Request() req,\n  ) {\n    await this.checkAdmin(req);\n    return this.adminService.updateUserRole(userId, data.role as any);\n  }\n\n  @Get('courses')\n  async getCourses(@Request() req) {\n    await this.checkAdmin(req);\n    return this.adminService.getAllCourses();\n  }\n\n  @Delete('courses/:id')\n  async deleteCourse(@Param('id') courseId: string, @Request() req) {\n    await this.checkAdmin(req);\n    return this.adminService.deleteCourse(courseId);\n  }\n\n  // Practice Test Management\n  @Get('practice-tests')\n  async getPracticeTests(@Request() req) {\n    await this.checkAdmin(req);\n    return this.adminService.getAllPracticeTests();\n  }\n\n  @Get('practice-tests/:id/analytics')\n  async getTestAnalytics(@Param('id') testId: string, @Request() req) {\n    await this.checkAdmin(req);\n    return this.adminService.getTestAnalytics(testId);\n  }\n\n  @Get('practice-tests/:id/results')\n  async getTestResults(@Param('id') testId: string, @Request() req) {\n    await this.checkAdmin(req);\n    return this.adminService.getTestResults(testId);\n  }\n\n  @Delete('practice-tests/:id')\n  async deletePracticeTest(@Param('id') testId: string, @Request() req) {\n    await this.checkAdmin(req);\n    return this.adminService.deletePracticeTest(testId);\n  }\n}\n"],"names":["AdminController","checkAdmin","req","user","role","ForbiddenException","getStats","adminService","getGlobalStats","getUsers","getAllUsers","updateRole","userId","data","updateUserRole","getCourses","getAllCourses","deleteCourse","courseId","getPracticeTests","getAllPracticeTests","getTestAnalytics","testId","getTestResults","deletePracticeTest"],"mappings":";;;;+BAgBaA;;;eAAAA;;;wBANN;8BACsB;8BACA;;;;;;;;;;;;;;;AAItB,IAAA,AAAMA,kBAAN,MAAMA;IAGX,MAAcC,WAAWC,GAAQ,EAAE;QACjC,IAAIA,IAAIC,IAAI,CAACC,IAAI,KAAK,SAAS;YAC7B,MAAM,IAAIC,0BAAkB,CAC1B;QAEJ;IACF;IAEA,MACMC,SAAS,AAAWJ,GAAG,EAAE;QAC7B,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACC,cAAc;IACzC;IAEA,MACMC,SAAS,AAAWP,GAAG,EAAE;QAC7B,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACG,WAAW;IACtC;IAEA,MACMC,WACJ,AAAaC,MAAc,EAC3B,AAAQC,IAAsB,EAC9B,AAAWX,GAAG,EACd;QACA,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACO,cAAc,CAACF,QAAQC,KAAKT,IAAI;IAC3D;IAEA,MACMW,WAAW,AAAWb,GAAG,EAAE;QAC/B,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACS,aAAa;IACxC;IAEA,MACMC,aAAa,AAAaC,QAAgB,EAAE,AAAWhB,GAAG,EAAE;QAChE,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACU,YAAY,CAACC;IACxC;IAEA,2BAA2B;IAC3B,MACMC,iBAAiB,AAAWjB,GAAG,EAAE;QACrC,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACa,mBAAmB;IAC9C;IAEA,MACMC,iBAAiB,AAAaC,MAAc,EAAE,AAAWpB,GAAG,EAAE;QAClE,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACc,gBAAgB,CAACC;IAC5C;IAEA,MACMC,eAAe,AAAaD,MAAc,EAAE,AAAWpB,GAAG,EAAE;QAChE,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACgB,cAAc,CAACD;IAC1C;IAEA,MACME,mBAAmB,AAAaF,MAAc,EAAE,AAAWpB,GAAG,EAAE;QACpE,MAAM,IAAI,CAACD,UAAU,CAACC;QACtB,OAAO,IAAI,CAACK,YAAY,CAACiB,kBAAkB,CAACF;IAC9C;IAnEA,YAAY,AAAiBf,YAA0B,CAAE;aAA5BA,eAAAA;IAA6B;AAoE5D"}