{"version":3,"sources":["../../src/admin/admin.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Patch,\n  Delete,\n  Body,\n  Param,\n  UseGuards,\n  Request,\n  ForbiddenException,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBearerAuth,\n  ApiExcludeController,\n} from '@nestjs/swagger';\nimport { AdminService } from './admin.service';\nimport { JwtAuthGuard } from '../auth/jwt-auth.guard';\n\n@ApiExcludeController()\n@ApiTags('Admin')\n@ApiBearerAuth()\n@Controller('admin')\n@UseGuards(JwtAuthGuard)\nexport class AdminController {\n  constructor(private readonly adminService: AdminService) {}\n\n  private checkAdmin(req: any) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (req.user.role !== 'ADMIN') {\n      throw new ForbiddenException('Ask For permission');\n    }\n  }\n\n  @Get('stats')\n  @ApiOperation({ summary: 'Get global stats' })\n  @ApiResponse({ status: 200, description: 'Return stats' })\n  @ApiResponse({ status: 403, description: 'Ask For permission' })\n  async getStats(@Request() req) {\n    this.checkAdmin(req);\n    return this.adminService.getGlobalStats();\n  }\n\n  @Get('users')\n  @ApiOperation({ summary: 'Get all users' })\n  async getUsers(@Request() req) {\n    this.checkAdmin(req);\n    return this.adminService.getAllUsers();\n  }\n\n  @Patch('users/:id/role')\n  @ApiOperation({ summary: 'Update user role' })\n  async updateRole(\n    @Param('id') userId: string,\n    @Body() data: { role: string },\n    @Request() req,\n  ) {\n    this.checkAdmin(req);\n    return this.adminService.updateUserRole(userId, data.role as any);\n  }\n\n  @Get('courses')\n  @ApiOperation({ summary: 'Get all courses' })\n  async getCourses(@Request() req) {\n    this.checkAdmin(req);\n    return this.adminService.getAllCourses();\n  }\n\n  @Delete('courses/:id')\n  @ApiOperation({ summary: 'Delete a course' })\n  async deleteCourse(@Param('id') courseId: string, @Request() req) {\n    this.checkAdmin(req);\n    return this.adminService.deleteCourse(courseId);\n  }\n\n  // Practice Test Management\n  @Get('practice-tests')\n  @ApiOperation({ summary: 'Get all practice tests' })\n  async getPracticeTests(@Request() req) {\n    this.checkAdmin(req);\n    return this.adminService.getAllPracticeTests();\n  }\n\n  @Get('practice-tests/:id/analytics')\n  @ApiOperation({ summary: 'Get test analytics' })\n  async getTestAnalytics(@Param('id') testId: string, @Request() req) {\n    this.checkAdmin(req);\n    return this.adminService.getTestAnalytics(testId);\n  }\n\n  @Get('practice-tests/:id/results')\n  @ApiOperation({ summary: 'Get test results' })\n  async getTestResults(@Param('id') testId: string, @Request() req) {\n    this.checkAdmin(req);\n    return this.adminService.getTestResults(testId);\n  }\n\n  @Delete('practice-tests/:id')\n  @ApiOperation({ summary: 'Delete a practice test' })\n  async deletePracticeTest(@Param('id') testId: string, @Request() req) {\n    this.checkAdmin(req);\n    return this.adminService.deletePracticeTest(testId);\n  }\n}\n"],"names":["AdminController","checkAdmin","req","user","role","ForbiddenException","getStats","adminService","getGlobalStats","getUsers","getAllUsers","updateRole","userId","data","updateUserRole","getCourses","getAllCourses","deleteCourse","courseId","getPracticeTests","getAllPracticeTests","getTestAnalytics","testId","getTestResults","deletePracticeTest","summary","status","description"],"mappings":";;;;+BA0BaA;;;eAAAA;;;wBAhBN;yBAOA;8BACsB;8BACA;;;;;;;;;;;;;;;AAOtB,IAAA,AAAMA,kBAAN,MAAMA;IAGHC,WAAWC,GAAQ,EAAE;QAC3B,sEAAsE;QACtE,IAAIA,IAAIC,IAAI,CAACC,IAAI,KAAK,SAAS;YAC7B,MAAM,IAAIC,0BAAkB,CAAC;QAC/B;IACF;IAEA,MAIMC,SAAS,AAAWJ,GAAG,EAAE;QAC7B,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACC,cAAc;IACzC;IAEA,MAEMC,SAAS,AAAWP,GAAG,EAAE;QAC7B,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACG,WAAW;IACtC;IAEA,MAEMC,WACJ,AAAaC,MAAc,EAC3B,AAAQC,IAAsB,EAC9B,AAAWX,GAAG,EACd;QACA,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACO,cAAc,CAACF,QAAQC,KAAKT,IAAI;IAC3D;IAEA,MAEMW,WAAW,AAAWb,GAAG,EAAE;QAC/B,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACS,aAAa;IACxC;IAEA,MAEMC,aAAa,AAAaC,QAAgB,EAAE,AAAWhB,GAAG,EAAE;QAChE,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACU,YAAY,CAACC;IACxC;IAEA,2BAA2B;IAC3B,MAEMC,iBAAiB,AAAWjB,GAAG,EAAE;QACrC,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACa,mBAAmB;IAC9C;IAEA,MAEMC,iBAAiB,AAAaC,MAAc,EAAE,AAAWpB,GAAG,EAAE;QAClE,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACc,gBAAgB,CAACC;IAC5C;IAEA,MAEMC,eAAe,AAAaD,MAAc,EAAE,AAAWpB,GAAG,EAAE;QAChE,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACgB,cAAc,CAACD;IAC1C;IAEA,MAEME,mBAAmB,AAAaF,MAAc,EAAE,AAAWpB,GAAG,EAAE;QACpE,IAAI,CAACD,UAAU,CAACC;QAChB,OAAO,IAAI,CAACK,YAAY,CAACiB,kBAAkB,CAACF;IAC9C;IA7EA,YAAY,AAAiBf,YAA0B,CAAE;aAA5BA,eAAAA;IAA6B;AA8E5D;;;;QApEkBkB,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;QAOzBF,SAAS;;;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;;;;;;;QAWTA,SAAS;;;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;;;;;QAQTA,SAAS;;;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;;;;;QAOTA,SAAS"}